{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\Leonid\\\\dev\\\\react-mesto-auth\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toConsumableArray.js\";import _slicedToArray from\"C:\\\\Users\\\\Leonid\\\\dev\\\\react-mesto-auth\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import React from'react';import{useEffect,useState}from'react';import{CurrentUserContext}from'../contexts/CurrentUserContext.js';import{Routes,Route,useNavigate,useLocation}from\"react-router-dom\";import{api}from'../utils/api.js';import*as authApi from'../utils/authApi';import ProtectedRoute from'./ProtectedRoute';import InfoToolTip from'./InfoToolTip';import NotFound from'./NotFound';import Header from'./Header.js';import Main from'./Main.js';import Footer from'./Footer.js';import ImagePopup from'./ImagePopup.js';import EditProfilePopup from'./EditProfilePopup.js';import EditAvatarPopup from'./EditAvatarPopup.js';import AddPlacePopup from'./AddPlacePopup.js';import ConfirmPopup from'./ConfirmPopup';import Register from'./Register';import Login from'./Login';import MenuMobile from'./MenuMobile';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isEditProfilePopupOpen=_useState2[0],setIsEditProfilePopupOpen=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAddPlacePopupOpen=_useState4[0],setIsAddPlacePopupOpen=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isEditAvatarPopupOpen=_useState6[0],setIsEditAvatarPopupOpen=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isConfirmPopupOpen=_useState8[0],setIsConfirmPopupOpen=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isImagePopupOpen=_useState10[0],setIsImagePopupOpen=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),selectedCard=_useState12[0],setSelectedCard=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),cards=_useState14[0],setCards=_useState14[1];var _useState15=useState({}),_useState16=_slicedToArray(_useState15,2),currentUser=_useState16[0],setCurrentUser=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isLoading=_useState18[0],setIsLoading=_useState18[1];var _useState19=useState(null),_useState20=_slicedToArray(_useState19,2),deletedCard=_useState20[0],setDeletedCard=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),isLoggedIn=_useState22[0],setIsLoggedIn=_useState22[1];var _useState23=useState(''),_useState24=_slicedToArray(_useState23,2),email=_useState24[0],setEmail=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),isRegisterSuccessful=_useState26[0],setRegisterSuccessful=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),isInfoToolTipOpen=_useState28[0],setIsInfoToolTipOpen=_useState28[1];var navigate=useNavigate();var _React$useState=React.useState('menu-mobile_type_close'),_React$useState2=_slicedToArray(_React$useState,2),isShowMenu=_React$useState2[0],setIsShowMenu=_React$useState2[1];var _React$useState3=React.useState('header__menu_type_closed'),_React$useState4=_slicedToArray(_React$useState3,2),classHeaderMenu=_React$useState4[0],setClassHeaderMenu=_React$useState4[1];var location=useLocation();function tokenCheck(){var jwt=localStorage.getItem('jwt');if(!jwt){return;}authApi.verifyUser(jwt).then(function(data){setEmail(data.data.email);setIsLoggedIn(true);}).catch(function(err){console.log(err);});}useEffect(function(){tokenCheck();},[]);useEffect(function(){if(isLoggedIn){Promise.all([api.getUserInfo(),api.getInitialCards()]).then(function(_ref){var _ref2=_slicedToArray(_ref,2),user=_ref2[0],cards=_ref2[1];setCurrentUser(user);setCards(cards);}).catch(function(err){console.log(err);});}},[isLoggedIn]);useEffect(function(){isLoggedIn?navigate('/react-mesto-auth'):navigate('/sign-in');},[isLoggedIn]);function handleEditAvatarClick(){setIsEditAvatarPopupOpen(true);}function handleEditProfileClick(){setIsEditProfilePopupOpen(true);}function handleAddPlaceClick(){setIsAddPlacePopupOpen(true);}function closeAllPopups(){setIsAddPlacePopupOpen(false);setIsEditProfilePopupOpen(false);setIsEditAvatarPopupOpen(false);setIsConfirmPopupOpen(false);setIsInfoToolTipOpen(false);setIsImagePopupOpen(false);setSelectedCard(null);setDeletedCard(null);}function handleCardClick(card){setIsImagePopupOpen(true);setSelectedCard(card);}function handleUpdateUser(name,description){setIsLoading(true);api.editProfile({name:name,description:description}).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){console.log(err);}).finally(function(){setIsLoading(false);});}function handleUpdateAvatar(avatar){setIsLoading(true);api.updateUserAvatar(avatar).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){console.log(err);}).finally(function(){setIsLoading(false);});}function handleCardLike(card){var isLiked=card.likes.some(function(i){return i._id===currentUser._id;});if(!isLiked){api.addLike(card._id).then(function(newCard){setCards(function(cards){return cards.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(err){console.log(err);});}else{api.removeLike(card._id).then(function(newCard){setCards(function(cards){return cards.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(err){console.log(err);});}}function handleCardDeleteSubmit(card){setIsLoading(true);api.deleteCard(card._id).then(function(){setCards(function(cards){return cards.filter(function(c){return c._id!==card._id;});});closeAllPopups();}).catch(function(err){console.log(err);}).finally(function(){setIsLoading(false);});}function handleAddPlaceSubmit(name,link){setIsLoading(true);api.addCard({name:name,link:link}).then(function(newCard){setCards([newCard].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){console.log(err);}).finally(function(){setIsLoading(false);});}function handleConfirmCardDelete(card){setIsConfirmPopupOpen(true);setDeletedCard(card);}function onLogin(password,email){setIsLoading(true);authApi.signIn(password,email).then(function(data){var jwt=data.token;localStorage.setItem('jwt',jwt);setIsLoggedIn(true);setEmail(email);}).catch(function(err){console.log(err);}).finally(function(){setIsLoading(false);});}function onRegister(password,email){setIsLoading(true);authApi.signUp(password,email).then(function(data){setEmail(data.data.email);setIsInfoToolTipOpen(true);setRegisterSuccessful(true);setIsLoggedIn(true);}).catch(function(err){console.log(err);setIsInfoToolTipOpen(true);setRegisterSuccessful(false);}).finally(function(){setIsLoading(false);});}function onLogOut(){localStorage.removeItem('jwt');setIsLoggedIn(false);}function closeInfoToolTip(){closeAllPopups();isRegisterSuccessful?navigate('/react-mesto-auth'):navigate('/sign-up');}function showMenu(){if(isShowMenu==='menu-mobile_type_close'){setIsShowMenu('menu-mobile_type_open');}else{setIsShowMenu('menu-mobile_type_close');}if(classHeaderMenu==='header__menu_type_opened'){setClassHeaderMenu('header__menu_type_closed');}else{setClassHeaderMenu('header__menu_type_opened');}}return/*#__PURE__*/_jsxs(CurrentUserContext.Provider,{value:currentUser,children:[isLoggedIn&&/*#__PURE__*/_jsx(MenuMobile,{email:email,onLogOut:onLogOut,isShowMenu:isShowMenu}),/*#__PURE__*/_jsx(Header,{isLoggedIn:isLoggedIn,email:email||'',onLogOut:onLogOut,showMenu:showMenu,locaction:location,classHeaderMenu:classHeaderMenu}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:'/react-mesto-auth',element:/*#__PURE__*/_jsx(ProtectedRoute,{isLoggedIn:isLoggedIn,children:/*#__PURE__*/_jsx(Main,{onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onEditAvatar:handleEditAvatarClick,onCardClick:handleCardClick,cards:cards,onCardLike:handleCardLike,onCardDelete:handleConfirmCardDelete})})}),/*#__PURE__*/_jsx(Route,{path:'/sign-up',element:/*#__PURE__*/_jsx(Register,{isLoading:isLoading,onRegister:onRegister}),isLoggedIn:isLoggedIn}),/*#__PURE__*/_jsx(Route,{path:'/sign-in',element:/*#__PURE__*/_jsx(Login,{onLogin:onLogin,isLoggedIn:isLoggedIn,isLoading:isLoading})}),/*#__PURE__*/_jsx(Route,{path:'*',element:/*#__PURE__*/_jsx(NotFound,{isLoggedIn:isLoggedIn})})]}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser,onLoading:isLoading}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar,onLoading:isLoading}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit,onLoading:isLoading}),/*#__PURE__*/_jsx(ConfirmPopup,{isOpen:isConfirmPopupOpen,onClose:closeAllPopups,onLoading:isLoading,card:deletedCard,onSubmit:handleCardDeleteSubmit}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,isOpen:isImagePopupOpen,onClose:closeAllPopups}),/*#__PURE__*/_jsx(InfoToolTip,{isSuccess:isRegisterSuccessful,isOpen:isInfoToolTipOpen,onClose:closeInfoToolTip})]});}export default App;","map":{"version":3,"sources":["C:/Users/Leonid/dev/react-mesto-auth/src/components/App.js"],"names":["React","useEffect","useState","CurrentUserContext","Routes","Route","useNavigate","useLocation","api","authApi","ProtectedRoute","InfoToolTip","NotFound","Header","Main","Footer","ImagePopup","EditProfilePopup","EditAvatarPopup","AddPlacePopup","ConfirmPopup","Register","Login","MenuMobile","App","isEditProfilePopupOpen","setIsEditProfilePopupOpen","isAddPlacePopupOpen","setIsAddPlacePopupOpen","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","isConfirmPopupOpen","setIsConfirmPopupOpen","isImagePopupOpen","setIsImagePopupOpen","selectedCard","setSelectedCard","cards","setCards","currentUser","setCurrentUser","isLoading","setIsLoading","deletedCard","setDeletedCard","isLoggedIn","setIsLoggedIn","email","setEmail","isRegisterSuccessful","setRegisterSuccessful","isInfoToolTipOpen","setIsInfoToolTipOpen","navigate","isShowMenu","setIsShowMenu","classHeaderMenu","setClassHeaderMenu","location","tokenCheck","jwt","localStorage","getItem","verifyUser","then","data","catch","err","console","log","Promise","all","getUserInfo","getInitialCards","user","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","closeAllPopups","handleCardClick","card","handleUpdateUser","name","description","editProfile","res","finally","handleUpdateAvatar","avatar","updateUserAvatar","handleCardLike","isLiked","likes","some","i","_id","addLike","newCard","map","c","removeLike","handleCardDeleteSubmit","deleteCard","filter","handleAddPlaceSubmit","link","addCard","handleConfirmCardDelete","onLogin","password","signIn","token","setItem","onRegister","signUp","onLogOut","removeItem","closeInfoToolTip","showMenu"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useEffect, useState } from 'react';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext.js';\nimport { Routes, Route, useNavigate, useLocation } from \"react-router-dom\";\nimport { api } from '../utils/api.js';\nimport * as authApi from '../utils/authApi'\nimport ProtectedRoute from './ProtectedRoute';\nimport InfoToolTip from './InfoToolTip';\nimport NotFound from './NotFound';\nimport Header from './Header.js';\nimport Main from './Main.js';\nimport Footer from './Footer.js';\nimport ImagePopup from './ImagePopup.js';\nimport EditProfilePopup from './EditProfilePopup.js';\nimport EditAvatarPopup from './EditAvatarPopup.js';\nimport AddPlacePopup from './AddPlacePopup.js';\nimport ConfirmPopup from './ConfirmPopup';\nimport Register from './Register';\nimport Login from './Login';\nimport MenuMobile from './MenuMobile';\n\nfunction App() {\n\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = useState(false);\n  const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = useState(false);\n  const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = useState(false)\n  const [isConfirmPopupOpen, setIsConfirmPopupOpen] = useState(false);\n  const [isImagePopupOpen, setIsImagePopupOpen] = useState(false);\n  const [selectedCard, setSelectedCard] = useState(null);\n  const [cards, setCards] = useState([]);\n  const [currentUser, setCurrentUser] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [deletedCard, setDeletedCard] = useState(null);\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [email, setEmail] = useState('');\n  const [isRegisterSuccessful, setRegisterSuccessful] = useState(false);\n  const [isInfoToolTipOpen, setIsInfoToolTipOpen] = useState(false);\n  const navigate = useNavigate();\n  const [isShowMenu, setIsShowMenu] = React.useState('menu-mobile_type_close');\n  const [classHeaderMenu, setClassHeaderMenu] = React.useState('header__menu_type_closed');\n  const location = useLocation();\n\n  function tokenCheck() {\n    const jwt = localStorage.getItem('jwt');\n    if (!jwt) {\n      return\n    }\n    authApi.verifyUser(jwt)\n      .then((data) => {\n        setEmail(data.data.email);\n        setIsLoggedIn(true)\n      })\n      .catch((err) => {\n        console.log(err);\n      })\n  }\n\n  useEffect(() => {\n    tokenCheck();\n  }, []);\n\n  useEffect(() => {\n    if (isLoggedIn) {\n      Promise.all([api.getUserInfo(), api.getInitialCards()])\n        .then(([user, cards]) => {\n          setCurrentUser(user);\n          setCards(cards);\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    }\n  }, [isLoggedIn])\n\n  useEffect(() => {\n    isLoggedIn ? navigate('/react-mesto-auth') : navigate('/sign-in');\n  }, [isLoggedIn])\n\n\n  function handleEditAvatarClick() {\n    setIsEditAvatarPopupOpen(true);\n  }\n\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n\n  function handleAddPlaceClick() {\n    setIsAddPlacePopupOpen(true);\n  }\n\n  function closeAllPopups() {\n    setIsAddPlacePopupOpen(false);\n    setIsEditProfilePopupOpen(false);\n    setIsEditAvatarPopupOpen(false);\n    setIsConfirmPopupOpen(false);\n    setIsInfoToolTipOpen(false);\n    setIsImagePopupOpen(false);\n    setSelectedCard(null);\n    setDeletedCard(null);\n  }\n\n  function handleCardClick(card) {\n    setIsImagePopupOpen(true);\n    setSelectedCard(card);\n  }\n\n  function handleUpdateUser(name, description) {\n    setIsLoading(true);\n    api.editProfile({ name, description })\n      .then(res => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch(err => {\n        console.log(err)\n      })\n      .finally(() => {\n        setIsLoading(false);\n      })\n  }\n\n  function handleUpdateAvatar(avatar) {\n    setIsLoading(true);\n    api.updateUserAvatar(avatar)\n      .then(res => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch(err => {\n        console.log(err);\n      })\n      .finally(() => {\n        setIsLoading(false);\n      })\n  }\n\n  function handleCardLike(card) {\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\n    if (!isLiked) {\n      api.addLike(card._id)\n        .then((newCard) => {\n          setCards((cards) => cards.map((c) => c._id === card._id ? newCard : c));\n        })\n        .catch(err => {\n          console.log(err)\n        });\n    } else {\n      api.removeLike(card._id)\n        .then((newCard) => {\n          setCards((cards) => cards.map((c) => c._id === card._id ? newCard : c));\n        })\n        .catch(err => {\n          console.log(err);\n        })\n    }\n  }\n\n  function handleCardDeleteSubmit(card) {\n    setIsLoading(true);\n    api.deleteCard(card._id)\n      .then(() => {\n        setCards((cards) => {\n          return cards.filter(c => {\n            return c._id !== card._id\n          });\n        });\n        closeAllPopups();\n      })\n      .catch(err => {\n        console.log(err);\n      })\n      .finally(() => {\n        setIsLoading(false);\n      })\n  }\n\n  function handleAddPlaceSubmit(name, link) {\n    setIsLoading(true);\n    api.addCard({ name, link })\n      .then(newCard => {\n        setCards([newCard, ...cards]);\n        closeAllPopups();\n      })\n      .catch(err => {\n        console.log(err);\n      })\n      .finally(() => {\n        setIsLoading(false);\n      })\n  }\n\n  function handleConfirmCardDelete(card) {\n    setIsConfirmPopupOpen(true);\n    setDeletedCard(card);\n  }\n\n  function onLogin(password, email) {\n    setIsLoading(true);\n    authApi.signIn(password, email)\n      .then((data) => {\n        const jwt = data.token;\n        localStorage.setItem('jwt', jwt);\n        setIsLoggedIn(true);\n        setEmail(email);\n      })\n      .catch(err => {\n        console.log(err);\n      })\n      .finally(() => {\n        setIsLoading(false);\n      })\n  }\n\n  function onRegister(password, email) {\n    setIsLoading(true);\n    authApi.signUp(password, email)\n      .then((data) => {\n        setEmail(data.data.email);\n        setIsInfoToolTipOpen(true);\n        setRegisterSuccessful(true);\n        setIsLoggedIn(true);\n      })\n      .catch((err) => {\n        console.log(err);\n        setIsInfoToolTipOpen(true);\n        setRegisterSuccessful(false);\n      })\n      .finally(() => {\n        setIsLoading(false);\n      })\n  }\n\n  function onLogOut() {\n    localStorage.removeItem('jwt');\n    setIsLoggedIn(false);\n  }\n\n  function closeInfoToolTip() {\n    closeAllPopups();\n    isRegisterSuccessful ? navigate('/react-mesto-auth') : navigate('/sign-up');\n  }\n\n  function showMenu() {\n    if (isShowMenu === 'menu-mobile_type_close') {\n      setIsShowMenu('menu-mobile_type_open');\n    } else {\n      setIsShowMenu('menu-mobile_type_close');\n    }\n\n    if (classHeaderMenu === 'header__menu_type_opened') {\n      setClassHeaderMenu('header__menu_type_closed');\n    } else {\n      setClassHeaderMenu('header__menu_type_opened');\n    }\n  }\n\n\n  return (<CurrentUserContext.Provider value={currentUser}>\n    {isLoggedIn\n      && < MenuMobile\n        email={email}\n        onLogOut={onLogOut}\n        isShowMenu={isShowMenu}\n      />\n    }\n\n\n    <Header isLoggedIn={isLoggedIn}\n      email={email || ''}\n      onLogOut={onLogOut}\n      showMenu={showMenu}\n      locaction={location}\n      classHeaderMenu={classHeaderMenu} />\n    <Routes>\n      <Route path={'/react-mesto-auth'}\n        element={<ProtectedRoute isLoggedIn={isLoggedIn}>\n          <Main onEditProfile={handleEditProfileClick}\n            onAddPlace={handleAddPlaceClick}\n            onEditAvatar={handleEditAvatarClick}\n            onCardClick={handleCardClick}\n            cards={cards}\n            onCardLike={handleCardLike}\n            onCardDelete={handleConfirmCardDelete} />\n        </ProtectedRoute>} />\n      <Route path={'/sign-up'}\n        element={<Register isLoading={isLoading}\n          onRegister={onRegister} />}\n        isLoggedIn={isLoggedIn} />\n      <Route path={'/sign-in'}\n        element={<Login onLogin={onLogin}\n          isLoggedIn={isLoggedIn}\n          isLoading={isLoading} />} />\n      <Route path={'*'}\n        element={<NotFound isLoggedIn={isLoggedIn} />} />\n    </Routes>\n    <Footer />\n    <EditProfilePopup isOpen={isEditProfilePopupOpen}\n      onClose={closeAllPopups}\n      onUpdateUser={handleUpdateUser}\n      onLoading={isLoading} />\n    <EditAvatarPopup isOpen={isEditAvatarPopupOpen}\n      onClose={closeAllPopups}\n      onUpdateAvatar={handleUpdateAvatar}\n      onLoading={isLoading} />\n    <AddPlacePopup isOpen={isAddPlacePopupOpen}\n      onClose={closeAllPopups}\n      onAddPlace={handleAddPlaceSubmit}\n      onLoading={isLoading} />\n    <ConfirmPopup isOpen={isConfirmPopupOpen}\n      onClose={closeAllPopups}\n      onLoading={isLoading}\n      card={deletedCard}\n      onSubmit={handleCardDeleteSubmit} />\n    <ImagePopup card={selectedCard}\n      isOpen={isImagePopupOpen}\n      onClose={closeAllPopups} />\n    <InfoToolTip isSuccess={isRegisterSuccessful}\n      isOpen={isInfoToolTipOpen}\n      onClose={closeInfoToolTip} />\n  </CurrentUserContext.Provider>)\n}\n\nexport default App;\n\n"]},"metadata":{},"sourceType":"module"}